<h6>Version 0.0.2</h6>

<body id="myBody"
style="background-repeat:repeat; background-size:80%; overflow:hidden;"
background="myBackground01.jpg"
onkeydown="myKeyDown(event)">

<h1 align=center>t2a25-game-template-fred.html</h1>

<script>
/* =========================
   GLOBAL VARIABLES
========================= */
let myGlobalX = 0
let myClock
let playerYSpeed = 0
let onGround = false

let enemies = []

/* =========================
   COLLISION (TEMPLATE-STYLE)
========================= */
function hitBox(a, b){
  return !(
    a.right < b.left ||
    a.left > b.right ||
    a.bottom < b.top ||
    a.top > b.bottom
  )
}

function getBox(el){
  return {
    left: parseInt(el.style.left),
    right: parseInt(el.style.left) + parseInt(el.style.width),
    top: parseInt(el.style.top),
    bottom: parseInt(el.style.top) + parseInt(el.style.height)
  }
}

/* =========================
   PLAYER INPUT
========================= */
function myKeyDown(e){
  let p = document.getElementById('myImg01')

  if (e.key === 'a'){
    p.style.left = parseInt(p.style.left) - 10 + 'px'
  }

  if (e.key === 'd'){
    p.style.left = parseInt(p.style.left) + 10 + 'px'
  }

  if (e.key === 'w' && onGround){
    playerYSpeed = -15
    onGround = false
  }
}

/* =========================
   ENEMY SYSTEM (NO IMAGES)
========================= */
function spawnEnemy(x,y){
  let e = document.createElement('div')
  e.style.position = 'absolute'
  e.style.width = '50px'
  e.style.height = '80px'
  e.style.left = x + 'px'
  e.style.top = y + 'px'
  e.style.background = '#b00'
  e.style.borderRadius = '8px'
  document.body.appendChild(e)

  enemies.push({
    el: e,
    dir: 1,
    speed: 2,
    alive: true
  })
}

spawnEnemy(400,300)
spawnEnemy(650,300)

/* =========================
   GAME LOOP
========================= */
setInterval(function(){

  /* ---- PLAYER PHYSICS ---- */
  let p = document.getElementById('myImg01')
  playerYSpeed += 1
  p.style.top = parseInt(p.style.top) + playerYSpeed + 'px'

  if (parseInt(p.style.top) > 300){
    p.style.top = '300px'
    playerYSpeed = 0
    onGround = true
  }

  let playerBox = getBox(p)

  /* ---- ENEMIES ---- */
  enemies.forEach(enemy => {
    if (!enemy.alive) return

    let e = enemy.el
    e.style.left =
      parseInt(e.style.left) + enemy.dir * enemy.speed + 'px'

    if (parseInt(e.style.left) < 200 || parseInt(e.style.left) > 800){
      enemy.dir *= -1
    }

    let enemyBox = getBox(e)

    if (hitBox(playerBox, enemyBox)){
      alert('you lose')
      p.style.left = '50px'
      p.style.top = '300px'
    }
  })

}, 50)
</script>

<!-- PLAYER -->
<img id="myImg01"
style="position:absolute; width:60px; height:80px; top:300px; left:50px;"
src="myImage01.jpg">

<br><br>

<input type=button value="Scroll Background Left" onclick="{
  clearInterval(myClock)
  myClock = setInterval(function(){
    myGlobalX -= 5
    document.getElementById('myBody').style.backgroundPosition =
      myGlobalX + 'px 0px'
  }, 100)
}">
