<!DOCTYPE html>
<html>
<head>
<title>Shark Shooter: Boss Battle</title>
<script>
   // --- GLOBAL VARIABLES ---
   let myScore = 10
   let bossHP = 3  // Boss takes 3 hits
   let myGun01, myGun02
   let myShooting = 1

   // --- COLLISION DETECTOR ---
   function myHitOther(my1, my2) {
       const obj1 = document.getElementById(my1).getBoundingClientRect();
       const obj2 = document.getElementById(my2).getBoundingClientRect();

       // If object is off-screen, ignore collision
       if (obj1.left < -200 || obj2.left < -200) return false;

       return !(obj1.right < obj2.left || 
                obj1.left > obj2.right || 
                obj1.bottom < obj2.top || 
                obj1.top > obj2.bottom);
   }

   function myCheckHit() {
       let status = document.getElementById('myText01');
       status.value = "Score: " + myScore + " | Boss HP: " + bossHP;

       // 1. Check Player vs Enemies
       let enemies = ['myImg02', 'myImg03', 'myImg05', 'myImg06', 'bossShark'];
       
       for (let i = 0; i < enemies.length; i++) {
           let enemyId = enemies[i];
           if (myHitOther('myImg01', enemyId)) {
               document.getElementById('myImg01').style.left = '20px'; 
               status.value = 'You got bit! -1 Score';
               myScore -= 1;
           }
       }

       // 2. Check Bullets vs Normal Sharks
       let smallSharks = ['myImg02', 'myImg03', 'myImg05', 'myImg06'];
       for (let i = 0; i < smallSharks.length; i++) {
           checkBulletHit(smallSharks[i], false); // false = not a boss
       }

       // 3. Check Bullets vs Boss
       checkBulletHit('bossShark', true); // true = is boss

       // Win / Lose
       if (myScore <= 0) {
           alert('Game Over!');
           location.reload();
       }
       if (myHitOther('myImg01', 'myImg04')) {
           if (bossHP > 0) {
               status.value = "You can't leave until the Boss is dead!";
           } else {
               alert('You Win! Level Complete.');
               location = 'https://www.google.ca';
           }
       }
   }

   // Helper function for bullet collisions
   function checkBulletHit(enemyId, isBoss) {
       let enemy = document.getElementById(enemyId);
       let b1 = 'myBullet01';
       let b2 = 'myBullet02';

       if (myHitOther(b1, enemyId) || myHitOther(b2, enemyId)) {
           // Hide bullets immediately
           document.getElementById(b1).style.left = '-200px';
           document.getElementById(b2).style.left = '-200px';

           if (isBoss) {
               bossHP -= 1;
               if (bossHP <= 0) {
                   enemy.style.left = '-9999px'; // Kill Boss
                   myScore += 5;
               } 
           } else {
               enemy.style.left = '-9999px'; // Kill Normal Shark
               myScore += 1;
           }
       }
   }

   // --- SHOOTING WITH MOUSE AIM ---
   function myShoot(event) {
       // Prevent shooting if clicking buttons
       if (event.target.tagName == 'INPUT') return;

       if (myShooting > 2) { myShooting = 1 }
       let bulletId = (myShooting == 1) ? 'myBullet01' : 'myBullet02';
       let bullet = document.getElementById(bulletId);
       let player = document.getElementById('myImg01');

       // 1. Start bullet at Player center
       let pRect = player.getBoundingClientRect();
       let startX = pRect.left + (pRect.width / 2);
       let startY = pRect.top + (pRect.height / 2);
       
       bullet.style.left = startX + 'px';
       bullet.style.top = startY + 'px';

       // 2. Calculate Direction (Vector Math)
       let mouseX = event.clientX;
       let mouseY = event.clientY;
       
       let diffX = mouseX - startX;
       let diffY = mouseY - startY;

       // Calculate distance to normalize the speed
       let dist = Math.sqrt((diffX * diffX) + (diffY * diffY));
       
       // Speed of bullet (20)
       let speed = 20;
       let moveX = (diffX / dist) * speed;
       let moveY = (diffY / dist) * speed;

       // 3. Fire the interval
       let currentGun = (myShooting == 1) ? myGun01 : myGun02;
       clearInterval(currentGun);

       let intervalFunc = setInterval(() => {
           bullet.style.left = parseFloat(bullet.style.left) + moveX + 'px';
           bullet.style.top = parseFloat(bullet.style.top) + moveY + 'px';
           myCheckHit();
       }, 20);

       if (myShooting == 1) myGun01 = intervalFunc;
       else myGun02 = intervalFunc;

       // Bullet dies after 1.5 seconds
       setTimeout(() => { clearInterval(intervalFunc); bullet.style.left = '-200px'; }, 1500);

       myShooting++;
   }

   // --- ENEMY AI ---
   function moveEnemy(enemyID, speed) {
       let enemy = document.getElementById(enemyID);
       let player = document.getElementById('myImg01');

       // If enemy dead, stop moving
       if (parseInt(enemy.style.left) < -100) return;

       let enemyX = parseInt(enemy.style.left);
       let enemyY = parseInt(enemy.style.top);
       let playerX = parseInt(player.style.left);
       let playerY = parseInt(player.style.top);

       // Simple Chase Logic
       if (enemyX < playerX) enemy.style.left = (enemyX + speed) + 'px';
       if (enemyX > playerX) enemy.style.left = (enemyX - speed) + 'px';
       if (enemyY < playerY) enemy.style.top = (enemyY + speed) + 'px';
       if (enemyY > playerY) enemy.style.top = (enemyY - speed) + 'px';
   }

   // --- GAME LOOP ---
   setInterval(function() {
       // Player Gravity
       let player = document.getElementById('myImg01');
       if (parseInt(player.style.top) < 400) {
           player.style.top = (parseInt(player.style.top) + 2) + 'px';
       }

       // Move Normal Sharks (Speed 1)
       moveEnemy('myImg02', 1);
       moveEnemy('myImg03', 1);
       moveEnemy('myImg05', 1);
       moveEnemy('myImg06', 1);

       // Move Boss Shark (Speed 0.5 - Slower because he's big)
       moveEnemy('bossShark', 0.5);

   }, 40);

</script>
</head>

<body id="myBody" style="background-color: #87CEEB; overflow:hidden;" 
      onclick="myShoot(event)"
      onkeydown="
        let p = document.getElementById('myImg01');
        if (event.key == 'd') p.style.left = parseInt(p.style.left) + 15 + 'px';
        if (event.key == 'a') p.style.left = parseInt(p.style.left) - 15 + 'px';
        if (event.key == 'w') p.style.top = parseInt(p.style.top) - 30 + 'px';
        if (event.key == 's') p.style.top = parseInt(p.style.top) + 15 + 'px';
        myCheckHit();
      ">

<h1 align="center" style="color:white; text-shadow: 2px 2px black; pointer-events:none;">BOSS BATTLE</h1>

<div align="center" style="pointer-events:none;">
    <input id="myText01" type="text" value="Score: 10 | Boss HP: 3" size="50" readonly 
           style="font-size:20px; text-align:center; font-weight:bold; pointer-events:auto;">
    <br>
    <p><b>WASD</b> to Move | <b>Click ANYWHERE</b> to Shoot at mouse</p>
</div>

<img id="myImg01" src="ignore/meowl.png" style="position:absolute; width:60px; height:60px; left: 50px; top:200px; z-index:10;">

<img id="myImg02" src="ignore/BaskingShark.
