<!DOCTYPE html>
<html>
<head>
<title>Shark Shooter: Wave Survival</title>
<style>
    body { background-color: #004d7a; overflow:hidden; margin:0; font-family: sans-serif; }
    #overlay, #shopOverlay {
        display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.85); color: white; text-align: center; padding-top: 10%; z-index: 100;
    }
    #healthContainer {
        position: fixed; top: 20px; left: 20px; width: 200px; height: 25px; 
        background: #333; border: 2px solid white; z-index: 50;
    }
    #healthBar { width: 100%; height: 100%; background: #4CAF50; transition: width 0.3s; }
    .ui-panel { text-align: center; color: white; padding: 10px; background: rgba(0,0,0,0.3); }
    button { padding: 10px 20px; font-size: 16px; cursor: pointer; margin: 10px; border-radius: 5px; }
    .shop-item { display: inline-block; width: 200px; padding: 15px; border: 1px solid white; margin: 10px; }
</style>
<script>
   let myScore = 10;
   let playerMaxHealth = 10;
   let bossHP = 5;
   let myGun01, myGun02;
   let myShooting = 1;
   let gameActive = true;
   let inShop = false;
   let wave = 1;
   let enemyBaseSpeed = 0.8;
   let tripleShot = false;
   let playerSpeed = 25;

   function myHitOther(my1, my2) {
       const obj1 = document.getElementById(my1).getBoundingClientRect();
       const obj2 = document.getElementById(my2).getBoundingClientRect();
       if (obj1.left < -200 || obj2.left < -200 || 
           document.getElementById(my2).style.display === 'none') return false;
       return !(obj1.right < obj2.left || obj1.left > obj2.right || obj1.bottom < obj2.top || obj1.top > obj2.bottom);
   }

   function updateUI() {
       let hBar = document.getElementById('healthBar');
       let pct = (myScore / playerMaxHealth) * 100;
       hBar.style.width = pct + "%";
       hBar.style.background = pct < 30 ? "#ff4444" : "#4CAF50";
       document.getElementById('waveDisplay').innerText = "Wave: " + wave;
       document.getElementById('scoreDisplay').innerText = "Score (Gold): " + myScore;
   }

   // --- SHOP LOGIC ---
   function openShop() {
       inShop = true;
       document.getElementById('shopOverlay').style.display = 'block';
       document.getElementById('shopGold').innerText = myScore;
   }

   function closeShop() {
       inShop = false;
       document.getElementById('shopOverlay').style.display = 'none';
       startWave();
   }

   function buy(item) {
       if (item === 'health' && myScore >= 5) {
           myScore -= 5;
           playerMaxHealth += 2;
           myScore = playerMaxHealth;
       } else if (item === 'speed' && myScore >= 10) {
           myScore -= 10;
           playerSpeed += 5;
       } else if (item === 'triple' && myScore >= 15) {
           myScore -= 15;
           tripleShot = true;
       }
       document.getElementById('shopGold').innerText = myScore;
       updateUI();
   }

   // --- WAVE LOGIC ---
   function startWave() {
       wave++;
       enemyBaseSpeed += 0.2;
       let enemies = ['myImg02', 'myImg03', 'myImg05', 'myImg06'];
       enemies.forEach(id => {
           let e = document.getElementById(id);
           e.style.display = 'block';
           e.style.left = (window.innerWidth + Math.random() * 400) + "px";
           e.style.top = Math.random() * window.innerHeight + "px";
       });

       if (wave % 5 === 0) {
           let b = document.getElementById('bossShark');
           b.style.display = 'block';
           b.style.left = "1200px";
           bossHP = 5 + wave;
       }
       updateUI();
   }

   function checkWaveEnd() {
       let enemies = ['myImg02', 'myImg03', 'myImg05', 'myImg06', 'bossShark'];
       let allDead = enemies.every(id => document.getElementById(id).style.display === 'none' || parseInt(document.getElementById(id).style.left) < -200);
       
       if (allDead && !inShop) {
           if (wave % 2 === 0) openShop();
           else startWave();
       }
   }

   function handleEnemyDamage(enemyId) {
        if (enemyId === 'bossShark') {
            bossHP--;
            if (bossHP <= 0) {
                document.getElementById(enemyId).style.display = 'none';
                myScore += 20;
            }
        } else {
            document.getElementById(enemyId).style.display = 'none';
            myScore += 2;
        }
        checkWaveEnd();
   }

   function fireBullet(id, sX, sY, vX, vY) {
       let b = document.getElementById(id);
       b.style.left = sX + 'px'; b.style.top = sY + 'px';
       let timer = setInterval(() => {
           if (!gameActive || inShop) { clearInterval(timer); return; }
           b.style.left = parseFloat(b.style.left) + vX + 'px';
           b.style.top = parseFloat(b.style.top) + vY + 'px';
           
           let enemies = ['myImg02', 'myImg03', 'myImg05', 'myImg06', 'bossShark'];
           enemies.forEach(eId => {
               if (myHitOther(id, eId)) {
                   b.style.left = "-500px";
                   clearInterval(timer);
                   handleEnemyDamage(eId);
               }
           });
       }, 20);
       setTimeout(() => { clearInterval(timer); b.style.left = '-500px'; }, 4000);
   }

   function myShoot(event) {
       if (!gameActive || inShop || event.target.tagName == 'BUTTON') return;
       let pRect = document.getElementById('myImg01').getBoundingClientRect();
       let sX = pRect.left + 30, sY = pRect.top + 30;
       let dX = event.clientX - sX, dY = event.clientY - sY;
       let dist = Math.sqrt(dX*dX + dY*dY);
       let vX = (dX/dist)*15, vY = (dY/dist)*15;

       fireBullet('myBullet01', sX, sY, vX, vY);
       if (tripleShot) {
           fireBullet('myBulletB', sX, sY, vX, vY - 4);
           fireBullet('myBulletC', sX, sY, vX, vY + 4);
       }
   }

   function moveEnemy(id, speed) {
       let e = document.getElementById(id), p = document.getElementById('myImg01');
       if (e.style.display === 'none') return;
       let ex = parseFloat(e.style.left), ey = parseFloat(e.style.top);
       let px = parseFloat(p.style.left), py = parseFloat(p.style.top);
       e.style.left = (ex < px ? ex + speed : ex - speed) + 'px';
       e.style.top = (ey < py ? ey + speed : ey - speed) + 'px';
       if (myHitOther('myImg01', id)) {
           p.style.left = '20px'; myScore--; updateUI();
           if (myScore <= 0) { gameActive = false; document.getElementById('overlay').style.display='block'; }
       }
   }

   setInterval(() => {
       if (!gameActive || inShop) return;
       let p = document.getElementById('myImg01');
       if (parseFloat(p.style.top) < 550) p.style.top = (parseFloat(p.style.top) + 2) + 'px';
       
       ['myImg02', 'myImg03', 'myImg05', 'myImg06'].forEach(id => moveEnemy(id, enemyBaseSpeed));
       moveEnemy('bossShark', enemyBaseSpeed * 0.4);
   }, 40);
</script>
</head>

<body onclick="myShoot(event)" onkeydown="
    if(!gameActive || inShop) return;
    let p = document.getElementById('myImg01');
    if (event.key == 'd') p.style.left = (parseFloat(p.style.left)||0) + playerSpeed + 'px';
    if (event.key == 'a') p.style.left = (parseFloat(p.style.left)||0) - playerSpeed + 'px';
    if (event.key == 'w') p.style.top = (parseFloat(p.style.top)||0) - 60 + 'px';
    if (event.key == 's') p.style.top = (parseFloat(p.style.top)||0) + playerSpeed + 'px';
">

<div id="healthContainer"><div id="healthBar"></div></div>

<div class="ui-panel">
    <span id="waveDisplay" style="font-size: 24px; margin-right: 20px;">Wave: 1</span>
    <span id="scoreDisplay" style="font-size: 24px;">Score (Gold): 10</span>
</div>

<div id="shopOverlay">
    <h1>WAVE CLEARED - WELCOME TO THE SHOP</h1>
    <p>Gold: <span id="shopGold">0</span></p>
    <div class="shop-item">
        <h3>Extra Health</h3>
        <p>Cost: 5 Gold</p>
        <button onclick="buy('health')">Buy</button>
    </div>
    <div class="shop-item">
        <h3>Swim Speed</h3>
        <p>Cost: 10 Gold</p>
        <button onclick="buy('speed')">Buy</button>
    </div>
    <div class="shop-item">
        <h3>Triple Shot</h3>
        <p>Cost: 15 Gold</p>
        <button onclick="buy('triple')">Buy</button>
    </div>
    <br><br>
    <button onclick="closeShop()" style="background: #4CAF50; color: white;">NEXT WAVE</button>
</div>

<div id="overlay">
    <h1>GAME OVER</h1>
    <button onclick="location.reload()">RESTART</button>
</div>

<img id="myImg01" src="ignore/meowl.png" style="position:absolute; width:60px; height:60px; left:50px; top:200px;">
<img id="myImg02" src="ignore/BaskingShark.jpg" style="position:absolute; width:80px; height:40px; left:600px; top:100px;">
<img id="myImg03" src="ignore/BaskingShark.jpg" style="position:absolute; width:80px; height:40px; left:700px; top:300px;">
<img id="myImg05" src="ignore/BaskingShark.jpg" style="position:absolute; width:80px; height:40px; left:800px; top:50px;">
<img id="myImg06" src="ignore/BaskingShark.jpg" style="position:absolute; width:80px; height:40px; left:850px; top:400px;">
<img id="bossShark" src="ignore/BaskingShark.jpg" style="position:absolute; width:220px; height:120px; left:1200px; top:200px; border:4px solid red; display:none;">

<div id="myBullet01" style="position:absolute; width:12px; height:12px; background:yellow; border-radius:50%; left:-500px;"></div>
<div id="myBulletB" style="position:absolute; width:12px; height:12px; background:orange; border-radius:50%; left:-500px;"></div>
<div id="myBulletC" style="position:absolute; width:12px; height:12px; background:orange; border-radius:50%; left:-500px;"></div>

</body>
</html>
