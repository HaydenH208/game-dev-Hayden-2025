<!DOCTYPE html>
<html>
<head>
<title>Shark Shooter: Power-Up Edition</title>
<style>
    #overlay {
        display: none;
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.8);
        color: white;
        text-align: center;
        padding-top: 15%;
        z-index: 100;
        font-family: sans-serif;
    }
    .ui-panel {
        text-align: center; color: white; font-family: sans-serif; padding: 10px;
        background: rgba(0,0,0,0.3);
    }
    button { padding: 10px 20px; font-size: 16px; cursor: pointer; margin: 5px; }
</style>
<script>
   let myScore = 10;
   let bossHP = 3;
   let myGun01, myGun02;
   let myShooting = 1;
   let gameActive = true;
   let endlessMode = false;
   let enemyBaseSpeed = 0.7;
   let tripleShot = false;

   function myHitOther(my1, my2) {
       const obj1 = document.getElementById(my1).getBoundingClientRect();
       const obj2 = document.getElementById(my2).getBoundingClientRect();
       if (obj1.left < -200 || obj2.left < -200) return false;
       return !(obj1.right < obj2.left || obj1.left > obj2.right || obj1.bottom < obj2.top || obj1.top > obj2.bottom);
   }

   function startEndless() {
       endlessMode = true;
       document.getElementById('myImg04').style.display = 'none';
       document.getElementById('endlessBtn').style.display = 'none';
       document.getElementById('statusMsg').innerText = "SURVIVE THE SWARM!";
   }

   function showEndScreen(message) {
       gameActive = false;
       document.getElementById('overlay').style.display = 'block';
       document.getElementById('endMessage').innerText = message;
   }

   function myCheckHit() {
       if (!gameActive) return;
       document.getElementById('myText01').value = "Score: " + myScore + (endlessMode ? " | ENDLESS" : " | Boss HP: " + bossHP);

       let enemies = ['myImg02', 'myImg03', 'myImg05', 'myImg06', 'bossShark'];
       
       // Power up check
       if (myHitOther('myImg01', 'myImgPower')) {
           tripleShot = true;
           document.getElementById('myImgPower').style.left = '-500px';
           document.getElementById('statusMsg').innerText = "TRIPLE SHOT ACTIVE!";
           setTimeout(() => { tripleShot = false; document.getElementById('statusMsg').innerText = "Back to Normal Shot"; }, 10000);
       }

       for (let id of enemies) {
           if (myHitOther('myImg01', id)) {
               document.getElementById('myImg01').style.left = '20px'; 
               myScore -= 1;
           }
       }

       let bullets = ['myBullet01', 'myBullet02', 'myBulletB', 'myBulletC'];
       for (let b of bullets) {
           for (let enemyId of enemies) {
               if (myHitOther(b, enemyId)) {
                   document.getElementById(b).style.left = '-500px';
                   handleEnemyDamage(enemyId, (enemyId === 'bossShark'));
               }
           }
       }

       if (myScore <= 0) showEndScreen("GAME OVER!");
       if (!endlessMode && myHitOther('myImg01', 'myImg04') && bossHP <= 0) showEndScreen("YOU WIN!");
   }

   function handleEnemyDamage(enemyId, isBoss) {
        if (isBoss) {
            bossHP -= 1;
            if (bossHP <= 0) {
                if (endlessMode) respawnEnemy(enemyId);
                else document.getElementById(enemyId).style.left = '-9999px';
                myScore += 5;
            }
        } else {
            if (endlessMode) respawnEnemy(enemyId);
            else document.getElementById(enemyId).style.left = '-9999px';
            myScore += 1;
        }
   }

   function respawnEnemy(id) {
       let e = document.getElementById(id);
       e.style.left = (window.innerWidth + 100) + 'px';
       e.style.top = Math.random() * (window.innerHeight - 150) + 'px';
       enemyBaseSpeed += 0.05;
   }

   function fireBullet(id, startX, startY, moveX, moveY) {
       let b = document.getElementById(id);
       b.style.left = startX + 'px';
       b.style.top = startY + 'px';
       let timer = setInterval(() => {
           if (!gameActive) { clearInterval(timer); return; }
           b.style.left = parseFloat(b.style.left) + moveX + 'px';
           b.style.top = parseFloat(b.style.top) + moveY + 'px';
           myCheckHit();
       }, 20);
       setTimeout(() => { clearInterval(timer); b.style.left = '-500px'; }, 5000);
       return timer;
   }

   function myShoot(event) {
       if (!gameActive || event.target.tagName == 'BUTTON') return;
       
       let pRect = document.getElementById('myImg01').getBoundingClientRect();
       let sX = pRect.left + 30, sY = pRect.top + 30;
       let dX = event.clientX - sX, dY = event.clientY - sY;
       let dist = Math.sqrt(dX*dX + dY*dY);
       let vX = (dX/dist)*15, vY = (dY/dist)*15;

       let bId = (myShooting == 1) ? 'myBullet01' : 'myBullet02';
       clearInterval(myShooting == 1 ? myGun01 : myGun02);
       let t = fireBullet(bId, sX, sY, vX, vY);
       if (myShooting == 1) myGun01 = t; else myGun02 = t;

       if (tripleShot) {
           fireBullet('myBulletB', sX, sY, vX, vY - 5);
           fireBullet('myBulletC', sX, sY, vX, vY + 5);
       }
       myShooting = (myShooting == 1) ? 2 : 1;
   }

   setInterval(() => {
       if (!gameActive) return;
       let p = document.getElementById('myImg01');
       if (parseFloat(p.style.top) < 500) p.style.top = (parseFloat(p.style.top) + 2) + 'px';
       
       let ids = ['myImg02', 'myImg03', 'myImg05', 'myImg06'];
       for(let id of ids) moveEnemy(id, enemyBaseSpeed);
       moveEnemy('bossShark', enemyBaseSpeed * 0.4);

       // Random Powerup spawn
       if (Math.random() < 0.005 && parseFloat(document.getElementById('myImgPower').style.left) < 0) {
           document.getElementById('myImgPower').style.left = '800px';
           document.getElementById('myImgPower').style.top = '300px';
       }
   }, 40);

   function moveEnemy(id, speed) {
       let e = document.getElementById(id), p = document.getElementById('myImg01');
       let ex = parseFloat(e.style.left), ey = parseFloat(e.style.top);
       if (ex < -200) { if(endlessMode) respawnEnemy(id); return; }
       let px = parseFloat(p.style.left), py = parseFloat(p.style.top);
       e.style.left = (ex < px ? ex + speed : ex - speed) + 'px';
       e.style.top = (ey < py ? ey + speed : ey - speed) + 'px';
   }
</script>
</head>

<body id="myBody" style="background-color: #004d7a; overflow:hidden; margin:0;" onclick="myShoot(event)" onkeydown="
    if (!gameActive) return;
    let p = document.getElementById('myImg01');
    if (event.key == 'd') p.style.left = (parseFloat(p.style.left) || 0) + 25 + 'px';
    if (event.key == 'a') p.style.left = (parseFloat(p.style.left) || 0) - 25 + 'px';
    if (event.key == 'w') p.style.top = (parseFloat(p.style.top) || 0) - 50 + 'px';
    if (event.key == 's') p.style.top = (parseFloat(p.style.top) || 0) + 25 + 'px';
">

<div id="overlay">
    <h1 id="endMessage">GAME OVER</h1>
    <button onclick="location.reload()">Restart</button>
</div>

<div class="ui-panel">
    <h2 id="statusMsg">SHARK ATTACK</h2>
    <input id="myText01" type="text" value="Score: 10" readonly style="text-align:center; width:350px;">
    <button id="endlessBtn" onclick="startEndless()">Endless Mode</button>
</div>

<img id="myImg01" src="ignore/meowl.png" style="position:absolute; width:60px; height:60px; left:50px; top:200px;">
<img id="myImg02" src="ignore/BaskingShark.jpg" style="position:absolute; width:80px; height:40px; left:600px; top:100px;">
<img id="myImg03" src="ignore/BaskingShark.jpg" style="position:absolute; width:80px; height:40px; left:700px; top:300px;">
<img id="myImg05" src="ignore/BaskingShark.jpg" style="position:absolute; width:80px; height:40px; left:800px; top:50px;">
<img id="myImg06" src="ignore/BaskingShark.jpg" style="position:absolute; width:80px; height:40px; left:850px; top:400px;">
<img id="bossShark" src="ignore/BaskingShark.jpg" style="position:absolute; width:180px; height:100px; left:900px; top:200px; border:4px solid yellow;">
<img id="myImg04" src="ignore/liljit.jpg" style="position:absolute; width:60px; height:60px; left:1100px; top:500px;">
<img id="myImgPower" src="ignore/pukeko.jpg" style="position:absolute; width:40px; height:40px; left:-500px; border:2px solid gold;">

<div id="myBullet01" style="position:absolute; width:12px; height:12px; background:yellow; border-radius:50%; left:-500px;"></div>
<div id="myBullet02" style="position:absolute; width:12px; height:12px; background:yellow; border-radius:50%; left:-500px;"></div>
<div id="myBulletB" style="position:absolute; width:12px; height:12px; background:orange; border-radius:50%; left:-500px;"></div>
<div id="myBulletC" style="position:absolute; width:12px; height:12px; background:orange; border-radius:50%; left:-500px;"></div>

</body>
</html>
