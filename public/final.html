<!DOCTYPE html>
<html>
<head>
<title>Game Project</title>
<script>
   // global variables
   let myGlobalX = 0
   let myClock
   let myScore = 10
   let myGun01, myGun02
   let myShooting = 1

   // COLLISION CHECK
   function myHitOther(my1, my2) {
       // Using getBoundingClientRect is much more accurate than style.left
       const obj1 = document.getElementById(my1).getBoundingClientRect();
       const obj2 = document.getElementById(my2).getBoundingClientRect();

       return !(obj1.right < obj2.left || 
                obj1.left > obj2.right || 
                obj1.bottom < obj2.top || 
                obj1.top > obj2.bottom);
   }

   function myCheckHit() {
       let status = document.getElementById('myText01');
       status.value = "Score: " + myScore;

       // --- PLAYER COLLISIONS ---
       // Player hits Enemy 1 (Img02) or Enemy 2 (Img03)
       if (myHitOther('myImg01', 'myImg02') || myHitOther('myImg01', 'myImg03')) {
           document.getElementById('myImg01').style.left = '20px';
           status.value = 'Hit an enemy! -1 Score';
           myScore -= 1;
       }

       // --- BULLET COLLISIONS ---
       
       // Bullet 1 hits Enemy 2 (Shark 2)
       if (myHitOther('myBullet01', 'myImg03')) {
           resetBullet('myBullet01', myGun01);
           status.value = 'Shark 2 Down! +1 Score';
           myScore += 1;
       }
       // Bullet 2 hits Enemy 2 (Shark 2)
       if (myHitOther('myBullet02', 'myImg03')) {
           resetBullet('myBullet02', myGun02);
           status.value = 'Shark 2 Down! +1 Score';
           myScore += 1;
       }

       // Bullet 1 hits Enemy 1 (Shark 1) - THIS WAS MISSING
       if (myHitOther('myBullet01', 'myImg02')) {
           resetBullet('myBullet01', myGun01);
           status.value = 'Shark 1 Down! +1 Score';
           myScore += 1;
       }
       // Bullet 2 hits Enemy 1 (Shark 1) - THIS WAS MISSING
       if (myHitOther('myBullet02', 'myImg02')) {
           resetBullet('myBullet02', myGun02);
           status.value = 'Shark 1 Down! +1 Score';
           myScore += 1;
       }

       // Win/Loss conditions
       if (myScore <= 0) {
           alert('Game Over! Score hit zero.');
           location.reload();
       }

       if (myHitOther('myImg01', 'myImg04')) {
           alert('You Win! Moving to next level...');
           location = 'https://www.google.ca';
       }
   }

   // Helper to reset bullet
   function resetBullet(bulletName, gunTimer) {
        clearInterval(gunTimer);
        document.getElementById(bulletName).style.left = '-200px';
   }

   function myShoot() {
       if (myShooting > 2) { myShooting = 1 }

       let bulletId = (myShooting == 1) ? 'myBullet01' : 'myBullet02';
       
       let player = document.getElementById('myImg01');
       let bullet = document.getElementById(bulletId);

       // Start bullet at player position
       bullet.style.left = player.style.left;
       bullet.style.top = player.style.top;

       if (myShooting == 1) {
           clearInterval(myGun01);
           myGun01 = setInterval(() => { moveBullet('myBullet01') }, 20);
           // Bullet dies after 1 second
           setTimeout(() => { resetBullet('myBullet01', myGun01) }, 1000);
       } else {
           clearInterval(myGun02);
           myGun02 = setInterval(() => { moveBullet('myBullet02') }, 20);
           // Bullet dies after 1 second
           setTimeout(() => { resetBullet('myBullet02', myGun02) }, 1000);
       }
       myShooting++;
   }

   function moveBullet(id) {
       let b = document.getElementById(id);
       b.style.left = parseInt(b.style.left) + 15 + 'px'; // Increased speed slightly
       // REMOVED GRAVITY (style.top) HERE so it flies straight
       myCheckHit();
   }

   function myGround(obj, groundY) {
       if (parseInt(document.getElementById(obj).style.top) > groundY) {
           document.getElementById(obj).style.top = groundY + 'px';
       }
   }

   // Constant Gravity Loop
   setInterval(function() {
       // Player Gravity
       let player = document.getElementById('myImg01');
       player.style.top = parseInt(player.style.top) + 2 + 'px';
       myGround('myImg01', 400); // Floor is at 400px

       // Enemy Gravity
       myGround('myImg02', 400);
       myGround('myImg03', 400);
       document.getElementById('myImg02').style.top = parseInt(document.getElementById('myImg02').style.top) + 4 + 'px';
       document.getElementById('myImg03').style.top = parseInt(document.getElementById('myImg03').style.top) + 4 + 'px';
   }, 50);

</script>
</head>

<body id="myBody" style="background-color: #f0f0f0;" 
      onclick="myShoot()"
      onkeydown="
        // WASD Controls
        if (event.key == 'd') document.getElementById('myImg01').style.left = parseInt(document.getElementById('myImg01').style.left) + 15 + 'px';
        if (event.key == 'a') document.getElementById('myImg01').style.left = parseInt(document.getElementById('myImg01').style.left) - 15 + 'px';
        if (event.key == 'w') document.getElementById('myImg01').style.top = parseInt(document.getElementById('myImg01').style.top) - 30 + 'px';
        if (event.key == 's') document.getElementById('myImg01').style.top = parseInt(document.getElementById('myImg01').style.top) + 15 + 'px';
        
        // Spacebar to shoot
        if (event.key == ' ') myShoot();

        myCheckHit();
      ">

<h1 align="center"><font color="Purple">My Final Game</font></h1>

<div align="center">
    <input id="myText01" type="text" value="Score: 10" size="50" readonly><br><br>
    <p>Use WASD to Move, Left Click or Spacebar to Shoot</p>
</div>

<img id="myImg01" src="ignore/meowl.png" style="position:absolute; width:100px; height:80px; left: 10px; top:190px;">

<img id="myImg02" src="ignore/BaskingShark.jpg" style="position:absolute; width:100px; height:80px; left:350px; top:190px;">
<img id="myImg03" src="ignore/BaskingShark.jpg" style="position:absolute; width:100px; height:80px; left:500px; top:190px;">

<img id="myImg04" src="ignore/liljit.jpg" style="position:absolute; width:100px; height:80px; left:700px; top:400px;">

<img id="myBullet01" src="blossom.jpg" style="position:absolute; width:15px; height:15px; left:-200px; top:0px;">
<img id="myBullet02" src="blossom.jpg" style="position:absolute; width:15px; height:15px; left:-200px; top:0px;">

</body>
</html>
