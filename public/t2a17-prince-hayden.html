<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ASCII + Canvas Crown Drawer</title>
</head>
<body>

<!-- ASCII Crown -->
<pre id="output"></pre>

<button id="drawAsciiBtn">Draw ASCII Crown</button>
<button id="drawCanvasBtn">Draw Canvas Crown</button>
<button id="resetBtn">Reset</button>

<br><br>

<label for="speedSlider">Speed:</label>
<input type="range" id="speedSlider" min="10" max="300" value="50">
<span id="speedValue">50</span> ms per character

<br><br>

<!-- Canvas Crown -->
<canvas id="crownCanvas" width="400" height="250"></canvas>

<script>
  const output = document.getElementById("output");
  const drawAsciiBtn = document.getElementById("drawAsciiBtn");
  const drawCanvasBtn = document.getElementById("drawCanvasBtn");
  const resetBtn = document.getElementById("resetBtn");
  const speedSlider = document.getElementById("speedSlider");
  const speedValue = document.getElementById("speedValue");
  const canvas = document.getElementById("crownCanvas");
  const ctx = canvas.getContext("2d");

  // ASCII crown pattern
  const crownLines = [
    "        ^     ^     ^        ",
    "       /\\    /\\    /\\       ",
    "      /__\\  /__\\  /__\\      ",
    "     *----*----*----*       ",
    "      \\          /          ",
    "       \\________/           "
  ];

  let asciiIndex = 0;
  let asciiDrawing = false;
  let animatingSquare = false;

  // Define crown path points
  const points = [
    [50, 180], [100, 100],
    [150, 180], [200, 100],
    [250, 180], [300, 100],
    [350, 180]
  ];
  const pathPoints = [];
  for (let i = 0; i < points.length - 1; i++) {
    pathPoints.push([points[i], points[i + 1]]);
  }

  // --- ASCII Crown ---
  function drawASCIICrown() {
    if (asciiDrawing) return;
    asciiDrawing = true;
    output.textContent = "";
    asciiIndex = 0;
    const text = crownLines.join("\n");

    function drawStep() {
      if (asciiIndex < text.length) {
        output.textContent += text[asciiIndex];
        asciiIndex++;
        setTimeout(drawStep, parseInt(speedSlider.value));
      } else {
        asciiDrawing = false;
      }
    }
    drawStep();
  }

  // --- Canvas Crown ---
  function drawCanvasCrown() {
    if (animatingSquare) return;
    resetCanvas();
    animatingSquare = true;

    let lineIndex = 0;
    let progress = 0;
    let prevX = points[0][0];
    let prevY = points[0][1];

    function drawLine() {
      if (!animatingSquare) return;
      if (lineIndex >= pathPoints.length) {
        animatingSquare = false;
        return;
      }

      const [[x1, y1], [x2, y2]] = pathPoints[lineIndex];
      const dx = x2 - x1;
      const dy = y2 - y1;

      const step = 1 / (400 / parseInt(speedSlider.value));

      const currentX = x1 + dx * progress;
      const currentY = y1 + dy * progress;

      // Draw gold trail
      ctx.beginPath();
      ctx.moveTo(prevX, prevY);
      ctx.lineTo(currentX, currentY);
      ctx.strokeStyle = "gold";
      ctx.lineWidth = 3;
      ctx.stroke();

      // Draw red square
      ctx.fillStyle = "red";
      ctx.fillRect(currentX - 4, currentY - 4, 8, 8);

      prevX = currentX;
      prevY = currentY;

      progress += step;

      if (progress >= 1) {
        progress = 0;
        lineIndex++;
        if (lineIndex < pathPoints.length) {
          prevX = pathPoints[lineIndex][0][0];
          prevY = pathPoints[lineIndex][0][1];
        }
      }

      requestAnimationFrame(drawLine);
    }

    requestAnimationFrame(drawLine);
  }

  // --- Reset everything ---
  function resetAll() {
    asciiDrawing = false;
    animatingSquare = false;
    output.textContent = "";
    asciiIndex = 0;
    resetCanvas();
  }

  function resetCanvas() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }

  // --- Live speed updates ---
  speedSlider.addEventListener("input", () => {
    speedValue.textContent = speedSlider.value;
  });

  // --- Button events ---
  drawAsciiBtn.addEventListener("click", drawASCIICrown);
  drawCanvasBtn.addEventListener("click", drawCanvasCrown);
  resetBtn.addEventListener("click", resetAll);
</script>

</body>
</html>
